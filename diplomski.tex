% Predlozak za pisanje diplomskog rada na PMF-MO
% Opcenita uputstva za LaTeX se mogu npr. naci na 
% http://web.math.hr/nastava/rp3, http://web.math.hr/nastava/s4-prof/latex.pdf
% NE PREPORUCA se "Ne baš tako kratak uvod u TEX", buduci se radi o vrlo starom prirucniku
% koji nije pogodan za moderne verzije LaTEXa.
% Originalna verzija "The not so short..." na http://tobi.oetiker.ch/lshort/lshort.pdf 
% je obnovljena i daje bolji uvid u moderne verzije LaTeXa

% Stil je optimiziran za kreiranje pdf dokumenta (npr. pomocu pdflatex-a, XeLaTeX-a)

\documentclass[a4paper,oneside,12pt]{memoir} % jednostrano: promijeniti twoside u oneside

% Paket inputenc omogucava direktno unosenje hrvatskih dijakritickih znakova 
% opcija utf8 za unicode (unix, linux, mac)
% opcija cp1250 za windowse
\usepackage[utf8]{inputenc}  % ukoliko se koristi XeLaTeX onda je \usepackage{xunicode}\usepackage{xltxtra}
\usepackage{color}
% Stil za diplomski, unutra je ukljucena podrska za hrvatski jezik
\usepackage{diplomski}
% bibliografija na hrvatskom
\usepackage[languagenames,fixlanguage,croatian]{babelbib} % zahtijeva datoteku croatian.bdf
% hiperlinkovi 
\usepackage[pdftex]{hyperref} % ukoliko se koristi XeLaTeX onda je \usepackage[xetex]{hyperref}

\DisemulatePackage{setspace}
\usepackage{setspace}

% Odabir familije fontova:
% koristenjem XeLaTeX-a mogu se koristiti svi fontovi instalirani na racunalu, npr
% \defaultfontfeatures{Mapping=tex-text}
% \setmainfont[Ligatures={Common}]{Hoefler Text}
% ili
% \newcommand{\nas}[1]{\fontspec{Adobe Garamond Pro}\fontsize{24pt}{24pt}\color{Chocolate}\selectfont #1}
% i onda \nas{Naslov ...}
\usepackage{txfonts} % times new roman 
% Paket graphicx sluzi za manipuliranje grafikom 
\usepackage[pdftex]{graphicx} % ukoliko se koristi XeLaTeX onda je \usepackage[xetex]{graphicx}
% Paket amsmath je vec ukljucen
% Dodatno definirane matematicke okoline:
% teorem (okolina: thm), lema (okolina: lem), korolar (okolina: cor),
% propozicija (okolina: prop), definicija (okolina: defn), napomena (okolina: rem),
% slutnja (okolina: conj), primjer (okolina: exa), dokaz (okolina: proof)
% Definirane su naredbe za ispisivanje skupova N, Z, Q, R i C
% Definirane su naredbe za funkcije koje se u hrvatskoj notaciji oznacavaju drukcije 
% nego u americkoj: tg, ctg, ... (\tgh za tangens hiperbolni)
% Takodjer su definirane naredbe za Ker i Im (da bi se razlikovala od naredbe za imaginarni dio kompleksnog
% broja, naredba se zove \slika).

\pagestyle{headings}
% uz paket fancyhdr mogu se lako kreirati fancy zaglavlja i podnozja



% Podaci koje treba unijeti
\title{DNA kriptografija}
\author{Antonio Kovačić}
\advisor{prof. dr. sc. Andrej Dujella}  % obavezno s titulom (prof. dr. sc ili doc. dr. sc.)
\date{srpanj, 2014.}  % oblika mjesec, godina

% Moguce je unijeti i posvetu
% Ukoliko nema posvete, dovoljno je iskomentirati/izbrisati sljedeci redak 
\dedication{Ovaj diplomski rad posvećujem svojim roditeljima, sestri, braći, prijateljima, mentoru, profesorima, kolegama s faksa, kao i svim ljudima koji su doprinijeli kako mom intelektualnom rastu, tako i mom rastu kao cjelovite osobe.}

\begin{document}

% Naredna frontmatter generira naslovnu stranicu, stranicu za potpise povjerenstva, eventualnu posvetu i sadrzaj
% Moze se iskomentirati ukoliko nije u pitanju konacna verzija
\frontmatter

% Tekst diplomskog ...
\begin{spacing}{1.5}
% Diplomski rad treba poceti s uvodnim poglavljem  
\begin{intro}

U današnje vrijeme svjedoci smo nagloga porasta razmjene podataka. Naglim napretkom današnjih računala, javila se potreba za povećanjem sigurnosti, odnosno zaštite podataka, koji putuju preko komunikacijskog kanala. Današnji kriptosustavi omogućuju siguran prijenos takvih podataka, a ključ njihovog razbijanja zapravo leži u faktoriziranju nekog \textit{velikog} broja (na primjer \textsc{RSA} kriptosustav). Na današnjim računalima, takav problem nije lako riješiv - pa su ti sustavi još uvijek sigurni. Razvojem novih teoretskih modela računala - koji se pokušavaju i u praksi realizirati - uočeno je da problem faktorizacije neće biti više takav problem. Primjer jednog takvog računala je kvantno računalo za kojeg postoji algoritam (\textit{Shorov algoritam}) koji faktorizira broj u polinomnom vremenu.
Time se javila potreba za osmišljanjem  novih teoretskih modela računala - odnosno kriptosustava - koji bi bili otporni na kvantno izračunavanje - ne bi se mogli probiti uporabom kvantnog računala u nekom razumnom vremenu. Takve kriptosustave ćemo zvati \textit{kvantno rezistentnima}.
Tema ovog diplomskog rada biti će DNA kriptografija. Kratko rečeno, radi se o teoretskom modelu kriptografskog sustava koji pomoću DNA izračunavanja šifrira podatke. Prednost takvog sustava jest upravo što je kvantno rezistentan.\\[0.2cm]
U ovom radu najprije ćemo se ukratko upoznati s pojmom DNA računala, odnosno DNA izračunavanja, složenosti DNA računala te algoritmom za enkripciju, odnosno dekripciju podataka pomoću DNA računala.
\end{intro}
\chapter{DNA računalo}
\section{DNA izračunljivost}
\label{sec:DNAizr}
DNA stroj, kao ni DNA izračunavanje nećemo striktno definirati već će definicija biti opisna - u definiciji ćemo reći koje operacije DNA stroj može izvršavati, i što pri tome mora biti zadovoljeno.\\ Prije nego definiramo DNA stroj moramo definirati neke pojmove iz logike sudova i kombinatorike.
\begin{defn}
\textbf{Alfabet} je proizvoljan konačan skup, čije elemente nazivamo \textbf{simboli}.\\
Neka je $n \in \mathbb{N}$ proizvoljan te $A$ proizvoljan alfabet, proizvoljni element $w \in A^n$ zovemo \textbf{riječ alfabeta A}. Neka su $s_1,..., s_n \in A$, riječ $w=(s_1,...,s_n)$ alfabeta A još zapisujemo kao $w=s_1s_2...s_n$. Smatramo da postoji riječ alfabeta A, koju ćemo označavati s $\varepsilon$, koja se ne sastoji ni od jednog simbola i zovemo je \textbf{prazna riječ}. Po dogovoru smatramo da je $A^0=\{\varepsilon\}$. Skup svih riječi alfabeta $A$ označavamo sa $A^*$. Neka su $a=a_1...a_m$, te, $b=b_1...b_k \in A^*$, kažemo da je riječ $c \in A^*$ nastala \textbf{konkatenacijom} riječi $a$ i $b$ ako vrijedi $c=ab=a_1...a_mb_1...b_k$. Kažemo da je riječ $c \in A^*$ podriječ riječi $a \in A^*$, ako postoje riječi $b, d \in A^*$ tako da je $a=bcd$. \textbf{Duljina riječi} se definira kao funkcija $d:A^*\to \mathbb{N}$ sa:
\begin{align*}
	d(\varepsilon) :&= 0 \\
	d(wa) :&= d(w)+1
\end{align*}
\end{defn}
\begin{defn}
Neka je S proizvoljan konačan skup, a $m:S \to \mathbb{N}$ proizvoljna funkcija. \textbf{Multiskup M na skupu S} je uređeni par $M=(S,m)$. Za proizvoljan $x\in S$, $m(x)$ zovemo \textbf{kratnost} od $x$. \textbf{Kardinalnost multiskupa M} (broj elemenata), u oznaci $|M|$, se definira kao:
\[|M|:=\sum_{x \in S} m(x)\]
\end{defn}
\begin{defn}
 \textbf{DNA lanac} je proizvoljna riječ alfabeta \{A (adenin), G (gvanin), T(timin), C (citozin)\}. DNA stroj se sastoji od konstantnog broja konačnih skupova koje nazivamo \textbf{epruvete}, a čiji su elementi DNA lanci. Za proizvoljnu epruvetu K DNA stroja definiramo multiskup $MulS(K)$ kao multiskup svih riječi koje predstavljaju DNA lance sadržane u epruveti K. U DNA stroju su definirane slijedeće instrukcije:
    \begin{itemize}
        \item Kopiraj($K_1$,$K_2$) $\to$ uz pretpostavku da je $K_2$ = $\emptyset$ , kopira MulS($K_1$) u MulS($K_2$) time više $K_2$ nije prazan
        \item Spoji($K_1$, $K_2$, $K$) $\to$ uz pretpostavku da $K$=$\emptyset$: \[MulS(K)=MulS(K_1)\bigcup MulS(K_2) \]
        \item Uoči($K$) $\to$ ispituje je li $MulS(K)\neq\emptyset$, ako je rezultat operacije je $\top$, inače $\bot$. Također se može pročitati sadržaj epruvete $MulS(K)$.
        \item Odvoji(K,w) $\to$ za skup $K$ i riječ $w$ (iz $MulS(K)$) izbacuje sve riječi iz $K$ koje kao podriječ ne sadrže riječ $w$
        \item Izvadi(K,w) $\to$ $K\backslash Odvoji(K,w)\to $izbacuje sve riječi iz $K$ koje sadrže $w$
        \item Odvoji\textunderscore Pref(K,w) $\to$ izbacuje sve riječi iz K koje ne sadrže w kao prefiks
        \item Odvoji\textunderscore Suff(K,w) $\to$ izbacuje sve riječi iz K koje ne sadrže w kao sufiks
        \item Proširi(K) $\to$ multiskupu MulS(K) još jednom dodaje elemente od K
        \item Izdvoji\textunderscore po\textunderscore duljini(K, l) $\to$ iz K izbacuje sve riječi čija je duljina različita od l
        \item Konkatenacija(K) $\to$ na slučajan način izvodi operaciju konkatenacije nad riječima iz MulS(K) tako da duljina novonastalih riječi ne bude veća od neke konstante, a vraća multiskup koji sadrži sve riječi nastale tom konkatenacijom. Vjerojatnost nastajanja duljih riječi je veća. Ukoliko MulS(K) prije izvođenja ove operacije nad epruvetom K sadrži veliki broj kopija svake od riječi, tada će MulS(K) nakon izvođenja ove operacije nad epruvetom K sadržavati sve moguće kombinacije elemenata iz K.
            \begin{itemize}
                \item \textbf{Biološki komplement} DNA lanca H definiramo kao DNA lanac koja ima jednako znakova kao i H, ali je svaki znak A zamijenjen znakom T, a svaki znak C znakom G i obratno, i označavamo je s $\overline{H}$
                \item Neka riječ H ima duljinu $n \in 2\mathbb{N}$, tada definiramo \textbf{biološki prefiks} riječi H kao biološki komplement riječi sastavljene od prvih $\frac{n}{2}$ znakova iz H, slično definiramo i \textbf{biološki sufiks} riječi H kao biološki komplement riječi sastavljene od zadnjih $\frac{n}{2}$ znakova riječi H
                \item Smatramo da je operacija konkatenacije nad riječima H i J dopuštena ako postoji riječ L takva da je biološki sufiks od H prvih $\frac{n}{2}$  znakova od L, a biološki prefiks od J prvih $\frac{n}{2}$ znakova od L
            \end{itemize}
    \item Izreži(K) $\to$ na slučajan način “skraćuje” riječi iz MulS(K) do neke fiksne duljine
    \item Izaberi(K) $\to$ na slučajan način iz MulS(K) izabire neku riječ te “generira” novi skup sastavljen od samo te riječi

    \end{itemize}
    \textbf{Program za DNA stroj} definiramo kao konačan niz gornje navedenih instrukcija. U svakom koraku programa se može izvesti točno jedna instrukcija.  Kažemo da program P za DNA stroj \textbf{izračunava} funkciju $f:S \subseteq N^k \to \N$ ako vrijedi:\\
$\vec{x}=(x_1,...,x_k) \in S$ ako i samo ako program P za DNA stroj s ulazom  $\vec{x}$ (reprezentiranim pomoću DNA lanaca) u epruveti K završi s izvršavanjem te na kraju izvršavanja vrijedi \textit{Uoči(K)}$=\top$ te je pri tome $K=\{f(\vec{x})\}$.\\
Kažemo da je funkcija $f:\N \to \N$ \textbf{DNA izračunljiva} ako postoji program za DNA stroj koji ju izračunava.
\end{defn}
\begin{rem}
Vidimo da se sve ove operacije izvršavaju nad jednom epruvetom u jednom koraku, odnosno multiskupom $MulS(K)$. Što je veća kardinalnost multiskupa $MulS(K)$, to se više operacija na riječima izvrši istovremeno, a u stvarnom svijetu sve te operacije imaju svoje "biokemijske analogone" - biokemijske reakcije. Takvo računalo zapravo možemo interpretirati kao superračunalo s izuzetno velikim brojem procesora. U pozadini svega toga se zapravo krije masivni paralelizam. Memoriju DNA računala zapravo predstavljaju epruvete. Jasno je odakle naziv epruvete.\\
Uočimoo da je $MulS(K)$ definiran nad konačnim skupom pa je i on konačan - no vidimo da se on zapravo može proširiti nizom operacija \textit{Proširi} tako da je njegov kardinalitet izrazito velikog reda (nadeksponencijalnog) , ali u praksi se već sada zaključuje da to neće biti uvijek moguće - naime broj DNA lanaca u epruveti (laboratorijskoj) biti će ograničen volumenom te epruvete.\\
Uočimo da operacija konkatenacije uključuje vjerojatnosni efekt - \textit{vjerojatnost nastajanja duljih riječi konkatenacijom je veća} - odnosno dvije riječi iz skupa $K$ koje će se konkatenirati neće biti izabrane na slučajan način - već tako da se pokuša dobiti riječ maksimalne duljine (maksimalna duljina je određena nekom konstantom). Iz toga očito možemo vidjeti da sam ishod DNA računanja nije sasvim siguran  - no u praksi se pokazuje (pri sintezi DNA lanaca) da je to moguće - u tu svrhu je i uvedena pretpostavka da će  se, ukoliko $MulS(K)$ sadrži velik broj kopija od svake riječi iz $K$, dobiti svaka moguća konkatenacija riječi iz $K$.
\end{rem}
\section{O složenosti DNA računala}
Kako bi nešto rekli o složenosti DNA računala, najprije ćemo navesti nekoliko osnovnih definicija iz teorije složenosti algoritama, odnosno referencirati se na \cite{Sipser}.
\begin{defn}
\textbf{Turingov stroj} je uređena sedmorka $(Q, \Sigma , \Gamma , \delta, q_0, q_{DA}, q_{NE})$, gdje je redom:
\begin{itemize}
	\item Q konačan skup čije elemente nazivamo stanja
	\item $\Sigma$ je konačan skup, čije elemente nazivamo ulazni simboli, pretpostavljamo da $\Sigma$ ne sadrži "prazan simbol" kojeg označavamo sa $\varepsilon$
	\item $\Gamma$ je konačan skup kojeg nazivamo alfabet Turingovog stroja, pretpostavljamo da je $\varepsilon \in \Gamma$, te $\Sigma \subset \Gamma$
	\item $\delta : Q \times \Gamma \to Q \times \Gamma \times \{ L,D,S\}$ koju nazivamo funkcija prijelaza
	\item $q_0 \in Q$ nazivamo početnim stanjem
	\item  $q_{DA} \in Q$ nazivamo stanjem prihvaćanja
	\item $q_{NE} \in Q$ nazivamo stanjem odbijanja, te $q_{NE}\neq q_{DA}$
\end{itemize}
\end{defn}
\begin{rem} (Opis rada Turingovog stroja)\\
Turingov stroj zapravo ima četiri glavna dijela: kontrolnu jedinicu (koja zapravo oponaša dijelovanje funkcije $\delta$), beskonačnu traku, neograničenu s lijeve i desne strane, takvu da se u svakom trenutku rada stroja na jednom registru trake nalazi točno jedan simbol, memoriju u kojoj se pamti trenutačno stanje stroja te glavu za čitanje koja se u jednom koraku rada stroja može pomicati za točno jedno mjesto na traci: desno, lijevo ili ostati na istom simbolu. Glava se na početku nalazi na nekom mjestu na traci (unaprijed definiranom), zatim čita simbol. Pročitani simbol, u paru s trenutnim stanjem stroja "se šalje" u kontrolnu jedinicu. Glava nakon toga, najprije zamijeni pročitani simbol nekim drugim simbolom, stroj prelazi u novo stanje, a glava se pomiče na drugi registar (L (lijevo), D (desno)) ili ostaje na istom mjestu (S). \\
Vidimo da opisani Turingov stroj može stati u dva završna stanja $q_{DA}$, odnosno $q_{NE}$, takav Turingov stroj se naziva još odlučitelj. Uočimo da Turingov stroj ne mora nužno uvijek stati. Shematski prikaz Turingovog stroja možete vidjeti na slici \ref{fig:Turing}.\\
Nedeterministički Turingov stroj se definira na analogan način, samo što je funkcija prijelaza definirana sa: $\delta : Q \times \Gamma \to \mathcal{P}(Q \times \Gamma \times \{L,D,S\})$. 
\end{rem}
\begin{figure}[h!t]
\centering \includegraphics[height=200pt, width=400pt]{Turing.png}
\caption{Shematski prikaz Turingovog stroja}
\label{fig:Turing}
\end{figure} 
\begin{defn}
Neka su $f, g: \N \to \R^{+}$ dvije funkcije. Kažemo da je funkcija $g$ \textbf{asimptotska gornja međa} za funkciju $f$ ako postoje $c>0$ i $n_0 \in \N$ tako da za svaki $n \geq n_0$ vrijedi
\[f(n)\leq cg(n)\]
Činjenicu da je $g$ asimptotska međa od $f$ označavamo sa $f(n)=O(g(n)$. 
\end{defn}
Osnovne definicije (što je alfabet logike sudova, interpretacija, ispunjivost formule, konjunktivna, odnosno, disjunktivna normalna forma  i tako dalje) se mogu naći u \cite[s. ~12-25]{Vukovic}.\\
Više o Turingovom stroju te nekim pojmovima na koje se pozivamo u idućim rezultatima se mogu naći u:
\begin{itemize}
\item Turing prepoznatiljivost, Turing odlučivost \cite[s. ~141-142]{Sipser}
\item Vremenska složenost Turingovog stroja determinističkog se može naći u \cite[s. ~248]{Sipser}, a nedeterminističkog u \cite[s. ~255]{Sipser}
\item Klase vremenske složenosti:
 \begin{itemize}
 	\item $TIME(f(n))$ u \cite[s. ~251]{Sipser}
 	\item $P$  u \cite[s. ~258]{Sipser}
 	\item Vezano uz klasu $NP$ u \cite[s. ~265-267]{Sipser}
 \end{itemize}
 
 	\item Polinomna reducibilnost u \cite[s. ~272]{Sipser}
 	\item NP-potpunost u \cite[s. ~276]{Sipser}
\end{itemize}
Označimo sa $SAT$ skup definiran na idući način:
\[SAT=\{F: F \textrm{ je ispunjiva formula logike sudova }\}\]
Formulacija \textit{problema SAT} glasi:\\
\begin{center}
Za danu formulu logike sudova F koja je u konjunktivnoj normalnoj formi odrediti\\ vrijedi li $F \in  SAT$.
\end{center}
Konjunktivnu normalnu formu koja u svakoj svojoj elementarnoj disjunkciji sadrži točno $k \in \N \backslash \{0\}$ literala nazivamo $k$-knf. Formulacija problema $k-SAT$ glasi:
\begin{center}
	Za proizvoljnu formulu $F$ koja je $k$-knf odrediti je li $F$ ispunjiva. 
\end{center} 
U \cite[s. ~276-283]{Sipser} se može vidjeti da je problem $SAT$ \textit{NP-potpun} problem, kao i $3-SAT$.
Sljedeći teorem govori zapravo o tome da DNA računala, u pogledu vremenske složenosti, imaju bolja svojstva nego deterministički Turnigovi strojevi:
\begin{thm} (Lipton)
Za svaku konjunktivnu normalnu formu $F$ u kojoj se pojavljuje $n$ propozicionalih varijabli i $m$ klauzula, u $\mathcal{O}(m+1)$ separacija i $\mathcal{O}(m)$ spajanja te jednim uočavanjem možemo odlučiti vrijedi li $F \in SAT$
\end{thm}
Dokaz navedenog teorema se može naći u \cite{Lipton}.\\
S pogleda odlučivosti jezika ipak nemamo takav rezultat, odnosno postoji slutnja koja kaže:
\begin{conj} (Kvantna i biološka slutnja) Problem je odlučiv na DNA računalu ili kvantnom računalu ako i samo ako je Turing-odlučiv.
\end{conj}
Postavlja se prirodno pitanje kako izračunati složenost DNA računala. Odgovor je jednostavan: složenost DNA računala procijenjujemo brojem instrukcija koje DNA stroj izvrši, te s kardinalosti skupa $MulS(K)$. Zbog toga što kardinalnost skupa $MulS(K)$ može izrazito brzo rasti (samo jedna operacija \textit{Proširi(K)}, za pripadnu funkciju kratnosti $m$ multiskupa $MulS(K)$ vrijedi da je: $m_{nova}(x)=2\cdot m_{stara}(x)$, gdje je $m_{nova}(x)$ kratnost od $x$ nakon izvršenja operacije \textit{Proširi},a $m_{stara}(x)$ kratnost od $x$ prije izvršenja te iste operacije) prostorna složenost nekog programa za DNA stroj obično doseže nadeksponencijalnu veličinu (vidjet ćemo u idućem podpoglavlju takav slučaj). \\
U sljedećem potpoglavlju ćemo procijeniti složenost jednog programa za DNA stroj.
\subsection{Problem Hamiltonovog puta}
\begin{defn}
\textbf{Konačan usmjereni graf} je uređeni par $G=(V,E)$ gdje je V proizvoljan konačan skup čije elemente nazivamo \textbf{vrhovi}, a $E\subseteq V \times V$ skup čije elemente nazivamo \textbf{bridovi}. Ako je $E=V\times	V$ kažemo da je usmjereni graf $G$ \textbf{potpuni graf}. Kažemo da je brid $e$ \textbf{petlja} ako vrijedi:
$(\exists x \in V) : e=(x,x)$.
\textbf{Šetnja u grafu} G je $2n+1$-torka $(v_0,e_0,v_1,e_1,...,v_{n-1},e_{n-1}, v_{n})$, pri čemu vrijedi:
\begin{itemize}
	\item $(\forall i \in \{0,...,n\}) \quad v_i \in V$
	\item $(\forall i \in \{0,...,n-1\}) \quad e_i \in E$
	\item $e_i=(v_i, v_{i+1}), \forall i \in \{0,...,n-1\}$
\end{itemize}
Kažemo da šetnja  $(v_0,e_0,v_1,e_1,...,v_{n-1},e_{n-1}, v_{n})$ \textbf{prolazi kroz vrh} $x \in V$ ako postoji $i \in \{0,...,n\}$ takav da je $x=v_i$, te da šetnja \textbf{počinje} s vrhom $v_0$ i \textbf{zavšrava} s vrhom $v_n$. Duljina šetnje se definira kao broj bridova koji se pojavljuju u njoj.\\
\textbf{Staza} u grafu je šetnja $(v_0,e_0,v_1,e_1,...,v_{n-1},e_{n-1}, v_{n})$ za koju vrijedi 
\[(\forall i,j \in \{0,...,n-1\})\, (i\neq j) \to e_i \neq e_j\] \textbf{Put} u grafu je šetnja $(v_0,e_0,v_1,e_1,...,v_{n-1},e_{n-1}, v_{n})$ za koju vrijedi:
\[(\forall i,j \in \{0,...,n\})\, (i\neq j) \to v_i \neq v_j\] \textbf{Hamiltonov put} je put koji prolazi kroz sve vrhove grafa G.
\end{defn}
\begin{rem}
Neusmjereni graf se definira analogno, ali se skup bridova definira kao:
\[E\subseteq \{\{x,y\} : x, y \in V\}\]
Također, radi jednostavnosti, pretpostavili smo da između dva vrha $x,y \in V$ može biti najviše dva usmjerena brida i u tom slučaju vrijedi: $(x,y) \in E$ i $(y,x) \in E$.  
\end{rem}
Problem Hamiltonovog puta glasi:\\
\begin{center}
\textit{Postoji li u proizvoljnom konačnom grafu $G=(V,E)$ za vrhove $x,y \in V$  Hamiltonov put koji počinje s $x$, a završava s $y$.}
\end{center}
U \cite[s. ~286-291]{Sipser} se može vidjeti da je problem Hamiltonovog puta NP-potpun problem. U ovom poglavlju analiziramo \textit{Adlemanov algoritam} koji riješava problem u $\mathcal{O}(n \log (n))$ operacija. U kasnijim poglavljima ćemo obrazložiti reprezentaciju podataka pomoću DNA lanaca, za sada ćemo samo reći da su naši podaci reprezentirani lancima parne duljine $l$. Sada ćemo prezentirat Adlemanov algoriatam za traženje Hamiltonovog puta koji počinje s vrhom $v_{in}$, a završava s $v_{out}$ u usmjerenom označenom grafu $G=(V,E)$. Ali prije toga ćemo reći nešto o vezi bridova i vrhova. Ako su dani vrhovi $A$ i $B$ i reprezentirani riječima $H$ i $J$, tada je brid $(A,B)$ reprezentiran riječju koja je nastala konkatenacijom (u smislu operacije nad riječima) biološkog sufiksa riječi $H$ i biološkog prefiksa riječi $J$. Kako bi mogli razlikovati koji brid povezuje koje vrhove, uviđamo da svaki vrh mora imati jedinstveni prefiks i sufiks, a ne samo jedinstven prikaz jednom riječju. 
    Nakon što smo objasnili vezu između bridova i vrhova moramo najprije "pripremiti" epruvetu za algoritam. \[K=V\cup E\]
    U početku je upravo $MulS(K)=K$.\\
    \indent Adlemanov algoritam:
    \begin{enumerate}
        \item Ulaz: Graf $G=(V,E)$, $|V|=n$, $v_1=v_{in}$ vrh iz kojeg krećemo, $v_n=v_{out}$ vrh u kojem završavamo, stavi vrhove i bridove u $K$
        \item $ \lceil 2n\log_{2}(n) \rceil$ puta primjeni operaciju \textit{Proširi(K)} tako da dobiješ barem $2^{2n\log_{2}(n)}=n^{2n}$ kopija svake riječi u $MulS(K)$
        \item Primjeni operaciju \textit{Konkatenacija(K)} da dobiješ šetnju u $G$, tako da duljina šetnje bude manja od $n$ - broj bridova u šetnji može biti manji ili jednak $n$
        \item Primjeni \textit{Odvoji\textunderscore Pref(K, $v_{in}$)}: izbacujemo one šetnje koje ne počinju vrhom $v_{in}$
        \item  \textit{Odvoji\textunderscore Suff(K, $v_{out}$)} : izbacujemo one šetnje koje ne završavaju s $v_{out}$
        \item Primjeni operaciju \textit{Izdvoji\textunderscore po \textunderscore duljini(K, $l\cdot n + l\cdot (n-1) $)} da iz $K (MulS(K))$ izbaciš sve one riječi koje u sebi ne sadrže točno $n$ vrhova i $n-1$ bridova (šetnje čija je duljina točno $n-1$)
        \item na $v_i$ primjeni operaciju \textit{Odvoji(K, $v_i$)} , $\forall{i} \in \{2,3,...,n-1\}$: iz $MulS(K)$ ukloni sve one šetnje u kojima se neki od vrhova ne pojavljuje
        \item \textit{Uoči(K)}: postoji li Hamiltonov put
    \end{enumerate}


Nama zapravo bridovi u ovom algoritmu, na ovaj način konstruirani daju mogućnost povezivanja dva vrha koja su povezana nekim birdom (u smislu biokemije, igraju ulogu enzima inače se vrhovi ne bi mogli povezati). \\
Brojimo korake algoritma:
\begin{itemize}
\item 2: $\lceil 2n \log _2 (n) \rceil$ koraka
\item  3-6: Po jedan korak svaka operacija
\item 7: $n-2$ koraka
\item 8: jedan korak
\end{itemize}
Ukupno: $\lceil 2n \log _2 (n) \rceil + n-2 + 5=\lceil 2n \log _2 (n) \rceil + n+3 = \mathcal{O}(n \log(n))$ operacija. No, rekli smo da se složenost DNA stroja mjeri i kardinalnošću skupa $MulS(K)$ koji u jednom trenutku sadrži i $n^{2n}$ elemenata. 
Još je preostalo dokazati da algoritam radi:
\begin{thm} Neka je G=(V,E) usmjeren označen graf, te $v_{in}$ i $v_{out}$ elementi iz V, tada Adlemanov algoritam odlučuje postoji li u usmjerenom grafu G=(V,E) Hamiltonov put od $v_{in}$ do $v_{out}$. \end{thm}

\begin{proof}
    \begin{itemize}
        \item $|V|=n$, $K=V\cup E$ gdje smatramo da je svakom vrhu dodijeljen jedinstven prefiks i sufiks. Neka je minimalni DNA lanac duljine $l$.
        \item Definiramo rekurzivno skupove $MulS(K_n)$ odakle ćemo zapravo izvući kako izgleda naš skup $MulS(K)$ nakon primjene operacije \textit{Proširi(K)} $\lceil 2n\log_2(n) \rceil$ puta
        \[K_0=K \to MulS(K_0)=K_0\]
        \[MulS(K_{n+1})=MulS(K_n) \cup MulS(K_n) , n \in \mathbb{N}\]
        Nakon ovog koraka, redefiniramo skup MulS(K)
        \[MulS(K)=MulS(K_{\lceil 2n\log_2(n) \rceil})\]
        Zapravo sada trebamo dokazati da je $2^{\lceil 2n\log_2(n) \rceil}$ dovoljan broj kopija skupa K za kreiranje svih šetnji u grafu:
        \[2^{\lceil 2n\log_2(n) \rceil} \geq 2^{ 2n\log_2(n) } = n^{2n}\]
        pa je dovoljno pokazati da je $n^{2n}$ dovoljan broj kopija skupa K od kojih možemo kreirati sve šetnje u grafu. Bez smanjenja općenitosti u tu svrhu možemo pretpostaviti da je G potpuno povezan usmjeren graf (dakle svaki brid je povezan sa svakim u oba smjera). Zašto? Jer ako G nije potpuno povezan onda ima manji broj šetnji od potpuno povezanog usmjerenog grafa. \\
        \noindent U tu svrhu definiramo skup $A^k$:
        \[A^k=\{(b_1,...,b_k): b_i \in V\}\]
        Uvidimo da smo u skupu $A^k$ dozvolili i petlje! Dakle može postojati brid $(v_i, v_i)$. Kada to ne bi dozvolili, na uređenu $k$-torku bi samo još stavili uvjet da je $b_i \neq b_{i+1}, \quad \forall i \in \{1,...,k-1\}$.
        Sada, jer između svaka 2 vrha ima točno 1 brid za svaki smjer koji povezuje te vrhove, vidimo da su sve šetnje duljine $k-1$ jedinstveno određene skupom $A^k$. Pa su sve šetnje do duljine $n-1$ (jer ćemo tako izabrati operaciju konkatenacije da kreira šetnje duljine ne duže od $n-1$) reprezentirane idućim skupom:
        \[\bigcup_{k=1}^n A^k\]
        Preostalo je dokazati da kardinalnost gornjeg skupa nije veća od $n^{2n}$. Kardinalnost skupa $A^k$ je lako odrediti. Naime za prvu komponentu uređene $k$-torke ima $n$ mogućnosti, za $2$ isto $n$, općenito za $i$-tu komponentu ima $n$ mogućnosti.
        \[|A^k|=n^k \to \bigg|\bigcup_{k=1}^n A^k\bigg|=\sum_{k=1}^n |A^k|=\sum_{k=1}^n n^k=\frac{n(n^n-1)}{n-1}\]
        \[\frac{n(n^n-1)}{n-1} \leq \frac{n\cdot n^n}{n-1} \leq n\cdot n^n =n^{n+1} \leq n^{2n}\]
        \item Primjenom operacije \textit{Konkatenacija(K)} dobili smo sve moguće šetnje u grafu $G$ (spremljene u $MulS(K)$)
        \item Operacijama \textit{Odvoji\textunderscore Pref(K, $v_{in}$)} i \textit{Odvoji\textunderscore Suff(K, $v_{out}$)} iz skupa $MulS(K)$ izbacujemo sve one šetnje koje ne počinju vrhovima $v_{in}$ i $v_{out}$
        \item operacijom \textit{Izdvoji\textunderscore po\textunderscore duljini(K, $l\cdot n + l\cdot (n-1)$)} uklanjamo sve preostale bridove i one šetnje čija je duljina strogo manja od $n-1$.
        Sada su ostale šetnje duljine $n-1$, ali to još nisu putevi (a onda ni Hamiltonovi putevi). Kako ima $n$ vrhova, a šetnja je duljine $n-1$, to znači da je u šetnji točno $n$ vrhova kroz koje šetnja prolazi, ako se neki vrh ne nalazi u šetnji, to znači da se neki drugi vrh pojavljuje dva puta. A kako smo već uklonili one šetnje koje ne počinju s  $v_{in}$ i ne završavaju s $v_{out}$ jedino je preostalo ukloniti sve one šetnje koje ne sadrže neki $v_i \in V \backslash \{v_{in}, v_{out}\}$.
        \item Za svaki $x \in V \backslash \{v_{in}, v_{out}\}$ čini:
        \[Odvoji(K,x)\]
        \item Ovim su korakom zapravo u $MulS(K)$ ostali samo Hamiltonovi putevi koji počinju s  $v_{in}$ i završavaju s $v_{out}$, ako takvih ima, operacijom \textit{Uoči(K)} dobivamo rješenje.
    \end{itemize} 
\end{proof}
\chapter{DNA kriptografija}
\section{Osnovni biološki koncepti deoksiribonukleinske kiseline}
\label{sec:DNA}
\textbf{Deoksiribonukleinska kiselina} (DNA) sastavljena je od dva duga lanca nukleotida (polinukleotidni lanci) koji su omotani jedan oko drugoga, odnosno ima strukturu \textit{dvostruke uzvojnice }(engleski \textbf{double helix}) (slika \ref{fig:DNA}). \textbf{Nukleotid} je osnovna građevna jedinica DNA, a gradi ju jedna od četiri dušićne baze: \textit{adenina (A), gvanina (G), timina (T) i citozina (C)}, šećera pentoze te fosfatne skupine. Sa $1' - 5'$ označavamo ugljikove atome u molekuli šećera, a na slici \ref{fig:Nukleotid} se može vidjeti atomska struktura nukleotida. Vidimo da ako se na $2'$ veže hidroksilna skupina - govorimo o \textbf{ribonukleinskoj kiselini}, u kojoj se timin zamjenjuje \textit{uracinom (U)}, inače, ako se na $2'$ veže vodik, govorimo o DNA (pripadna pentoza je deoksiriboza). Veza između dva nukleotida je kovalentna, a nastaje tako da se hidroksilna skupina na $3'$ ugljikovom atomu pentoze veže s fosfatnom skupinom drugog nukleotida koja se nalazi na $5'$ ugljikovom atomu pripadne pentoze. Pripadna dva lanca koja sastavljaju jednu molekulu DNA su \textit{antiparalelni} što znači da moraju biti suprotne orijentacije - jedan lanac dvostruke uzvojnice mora završavati s 5' ugljikovim atomom kao krajem, a druga zavravati s 3' ugljikovim atomom kao kraje (slika \ref{fig:antipar}). Pri povezivanju pripadnih dušićnih baza uvijek se adenin povezuje s timinom, a gvanin s citozinom. Sada kada smo osbjasnili neke osnovne principe DNA molekule, komentirat ćemo neka tehnološka postignuća koja su biokemijski analogoni operacija DNA stroja navedenih u poglavlju \ref{sec:DNAizr}.
\textit{DNA sintetizator} je stroj koji kemijski sintetizira DNA lance. Umjetne jednolančane DNA (signle stranded DNA) koje ćemo kasnije označavati sa \textit{ssDNA} nazivamo oligonukleotide. Dvostruke uzvojnice ćemo nadalje označavati sa \textit{dsDNA}. U određenim uvjetima, komplementarne ssDNA mogu oformiti dsDNA, a taj proces se zove \textit{hibridizacija}. (Navesti ostale biokemijske operacije koje se mogu upotrebljavati).

\begin{figure}[h!t]
\centering \includegraphics[scale=0.8]{DNA.png}
\caption{Struktura DNA: a) 2D model, b) 3D model}
\label{fig:DNA}
\end{figure}

\begin{figure}[h!t]
\centering \includegraphics[scale=0.8]{hybrid.jpg}
\caption{Hibridizacija}
\label{fig:hybrid}
\end{figure}

\begin{figure}[h!t]
\centering \includegraphics[scale=1]{antipar.jpg}
\caption{Antiparalelnost DNA}
\label{fig:antipar}
\end{figure} 


\begin{figure}[h!t]
\centering \includegraphics[scale=0.5]{Nukleotid.png}
\caption{Nukleotid}
\label{fig:Nukleotid}
\end{figure} 

\newpage
\section{Reprezentacija podataka DNA lancima}
Reprezentacija podataka DNA lancima se vrši na idući način:
\texttt{ 
 \begin{enumerate}
 \item Ulaz: Tekst $T$
 \item Tekst $T$ $\to$ ASCII $T_A$ (Decimalni ili Hex)
 \item ASCII $T_A \to$ 8-bitni binarni prikaz $T_B$ 
 \item Svaka $2$ bita zamijeni pripadnom dušićnom bazom prema \ref{tab:rep}
\end{enumerate}
}
\begin{table}[!ht]
\centering
\begin{tabular}{|c|c|}
\hline 
$\mathbf{x \in \{0,1\}^2}$ & \textbf{Dušićna baza} \\ 
\hline 
00 & A \\ 
\hline 
01 & C \\ 
\hline 
10 & G \\ 
\hline 
11 & T \\ 
\hline 
\end{tabular}
\caption{Reprezentacija uređenog para bitova sa dušićnim bazama}
\label{tab:rep}
\end{table} 
\begin{exa}
Reprezentirajmo "DNA" sa DNA lancem:
\begin{table}[!ht]
\centering
\begin{tabular}{|c|c|c|c|}
\hline 
Tekst & ASCII kod & Binarni prikaz & DNA prikaz \\ 
\hline 
D & 44 & 01 00 01 00& CACA \\ 
\hline 
N & 4E & 01 00 11 10 & CATG \\ 
\hline 
A & 41 & 01 00 00 01 & CAAC \\ 
\hline 
\end{tabular} 
\caption{Reprezentacija riječi "DNA" DNA lancem }
\label{tab:prim}
\end{table}\\
Iz \ref{tab:prim} slijedi:
$"DNA"=(CACACATGCAAC)_{DNA}$
\end{exa}
Naravno, vidimo da bi ovakvu "šifru" bilo iznimno lako probiti pa reprezentaciju podataka nećemo razmatrati kao potencijalni kriptosustav jer bi njegova sigurnost bila izuzetno mala.
\section{Osnove kriptografije}
Kriptografija je znanstvena disciplina koja proučava metode koje u nesigurnom komunikacijskom kanalu  čuvaju integritet i sigurnost podataka i poruka te skrivaju njihov sadržaj od treće osobe, a tako da dane poruke može pročitati samo onaj kome su namijenjene. Razmatrat ćemo komunikaciju između dvoje sudionika: \textit{pošiljatelja (Alice)} i \textit{primatelja (Bob)}. Alice želi preko nesigurnog komunikacijskog kanala poslati poruku, tako da  treća osoba (Oscar ili Eva) ne može saznati sadržaj poruke. Poruku zovemo \textit{otvoreni tekst}. Kako bi sakrila sadržaj poruke, Alice transformira otvoreni tekst uporabom \textit{ključa}. Cijeli postupak transformacije sa ključem nazivamo \textit{šifriranje}, a rezultat šifriranja \textit{šifrat}. Alice šalje Bobu šifrat preko nesigurnog komunikacijskog kanala. Treća osoba pokuašava ukrasti šifrat te saznati njegov sadržaj, no ako je Alice koristila "dobro" šifriranje, treća osoba to neće bit u mogućnosti napraviti. Kada poruka dođe do Boba, on će, u slučaju da ima odgovarajući ključ, šifrat ponovno transformirati u otvoreni tekst, što zovemo \textit{dešifriranjem}. \textit{Kriptoanaliza (dekriptiranje)} je znanstvena disciplina koja proučava metode za čitanje skrivenih poruka bez poznavanja ključa. Kriptologija je znanstvena diciplina koja objedinjuje i kriptografiju i kriptoanalizu. Često za šifriranje odnosno dešifriranje koristimo određene postupke - \textit{kriptografske algoritme (šifre)}. Ti postupci su zapravo određene funkcije - funkcija \textit{enkripcije} općenito otvorenom tekstu (njegovim sastavnim jedinicama) pridružuje osnovne sastavnice šifrata, dok funkcija \textit{dekripcije} opet sastavnim jedinicama šifrata pridružuje sastavne jedinice otvorenog teksta. \textit{Prostor ključeva} je skup čiji su elementi svi mogući ključevi. \textit{Kriptosustav} objedinjuje kriptografski algoritam,   šifrate, ključeve te sve moguće otvorene tekstove.
Sada navodimo formalnu definiciju kriptosustava:
\begin{defn}
Kriptosustav je uređena petorka $(\mathcal{P}, \mathcal{C}, \mathcal{K}, \mathcal{E}, \mathcal{D})$ gdje su redom:
\begin{itemize}
	\item $\mathcal{P}$ konačan skup čije elemente nazivamo \textit{simbolima otvorenog teksta}
	\item $\mathcal{C}$ konačan skup čije elemente nazivamo \textit{simbolima šifrata}
	\item $\mathcal{K}$ je konačan skup čije elemente nazivamo \textit{ključevi}
	\item $\mathcal{E}=\{e :e \text{  je funkcija definirana sa e }:\mathcal{P} \to \mathcal{C} \}$ i $\mathcal{D}=\{d: d\text{ je funkcija definirana sa } d: \mathcal{C} \to \mathcal{P}\}$ su skupovi funkcija za koje vrijedi:
	\[(\forall K \in \mathcal{K})(\exists e_K \in \mathcal{E})(\exists d_K \in \mathcal{D}) : d_K(e_K(x))=x, \forall x \in \mathcal{P} \]
	
\end{itemize}
\end{defn}
\begin{rem}
U primjeni se često radi jednostavnosti kaže da je $\mathcal{P}$ konačan skup osnovnih elemenata otvorenog teksta, a $\mathcal{C}$ skup osnovnih elemenata šifrata. U zadnjoj točki definicije, radi jednostavnosti, navodi da je $x$ otvoreni tekst (odnosno $x \in \mathcal{P}^k$, za neki $k \in \N$). Naravno, to je zbog toga što se prirodno može uvesti "proširenje" funkcije $e_K$ i to na sljedeći način: \\ 
za $\vec{x}=(x_1,...,x_n) \in \mathcal{P}^n$ definira se da je \[e_K(\vec{x})=e_K(x_1)e_K(x_2)...e_K(x_n)\]
Analogno bi se "proširila" funkcija $d_K$. 
\end{rem}
Od načina (tipa operacija) šifriranja razlikujemo \textit{supstitucijske šifre} (svaki element otvorenog teksta se zamijenjuje nekim drugim tekstom, npr. "DNA" $\to$ "GRD"), \textit{transpozicijske šifre} u kojoj se permutiraju slova otvorenog teksta (npr. "DNA" $\to$ "NDA"). Postoje i kriptosustavi koji koriste i jednu i drugu metodu. Otvoreni tekst možemo pak podijeliti na blokove pa razlikujemo \textit{blokovne šifre} i  \textit{protočne šifre}	gdje šifriramo element po element otvorenog teksta. Prema javnosti ključeva razlikuejmo \textit{simetrične kriptosustave} i \textit{kriptosustave s javnim ključem}. U simetričnim kriptosustavima se ključ za dešifriranje može saznati iz ključa za šifriranje, pa je taj ključ \textit{tajan}, zbog čega ove kriptosustave nazivamo i \textit{kriptosustavi s tajnim ključem}. U drugom navedenom postoje dva ključa i ključ za dešifriranje se ne može izvesti iz ključa za šifriranje u nekom razumnom vremenu. U daljnjim razmatranjima pretpostavljat ćemo takozvano Kerckhoffsovo načelo:
\begin{center}
	\textit{Kriptosustav bi trebao biti siguran čak i ako se sve zna o njemu osim ključa.}
\end{center}
Pa ćemo pretpostaviti da napadač na kriptosustav zna koji alat za šifriranje koristimo, posjeduje šifrat i njemu odgovarajući otvoreni tekst, pretpostavljamo da ima mogućnost odabira otvorenog teksta i njemu pripadajućeg šifrata pa čak i da ima alat za dešifriranje na temelju kojeg iz danog šifrata može dobiti otvoreni tekst (cilj mu je saznati ključ za dešifriranje).
Više o kriptografiji se može naći u \cite{duje}
\section{DES kriptosustav}	
\subsection{Kratki prgled DES kriptosustava}
"Krajem 60-tih i početkom 70-tih godina 20. stoljeća, razvojem financijskih transakcija, kriptografija postaje zanimljiva sve većem broju potencijalnih korisnika. Dotad je glavna primjena kriptografije bila u vojne i diplomatske svrhe, pa je bilo normalno da svaka država (ili čak svaka zainteresirana državna organizacija) koristi svoju šifru za koju je vjerovala da je najbolja. No, tada se pojavila potreba za šifrom koju će moći koristiti korisnici širom svijeta, i u koju će svi oni moći imati povjerenje - dakle, pojavila se potreba uvođenja standarda u kriptografiji.\\
Godine 1972. američki National Bureau of Standards (NBS) inicirao je program za zaštitu računalnih i komunikacijskih podataka. Jedan je od ciljeva bio razvijanje jednog standardnog kriptosustava. Godine 1973. NSB je raspisao javni natječaj za takav kriptosustav. Taj kriptosustav je trebao zadovoljiti sljedeće uvjete:
\begin{itemize}
\item visoki stupanj sigurnosti
\item potpuna specifikacija i lako razumijevanje algoritma
\item sigurnost leži u ključu, a ne u tajnosti algoritma
\item dostupnost svim korisnicima
\item prilagodljivost uporabi u različitim primjenama
\item ekonomičnost implementacije u elektoničkim uređajima
\item efikasnost
\item mogućnost provjere
\item mogućnost izvoza (zbog američkih zakona)
\end{itemize}

Na tom natječaju niti jedan prijedlog nije zadovoljavao sve ove zahtjeve. Međutim, na ponovljeni natječaj iduće godine pristigao je prijedlog algoritma koji je razvio IBM-ov tim kriptografa. Algoritam je zasnovan na tzv. Feistelovoj šifri. Gotovo svi simetrični blokovni algoritmi koji su danas u uporabi koriste ideju koju je uveo Horst Feistel 1973. godine. Jedna od glavnih ideja je alternirana uporaba supstitucija i transpozicija kroz više iteracija (tzv. rundi).
Predloženi algoritam je nakon nekih preinaka, u kojima je sudjelovala i National Security Agency (NSA), prihvaćen kao standard 1976. godine i dobio je ime Data Encryption Standard (DES)."\footnote{\cite[s. ~?]{duje}}\\
Pogledajmo sada kako se kriptira DES algoritmom:
Pretpostavljamo da je duljina otvorenog teksta $x$ kojeg DES šifrira duljine 64 bita. DES koristi ključ $K=k_1...k_{56}$ duljine 56 bita.
Neka je $x=x_1...x_{64}$ otvoreni tekst. Najprije permutiramo $x$ fiksnom \textit{inicijalnom permutacijom} IP te dobivamo $x_0=IP(x)$ - IP $i$-ti bit od $x$ zamijenjuje sa $IP(i)$-tim bitom od $x$. Inicijalna permutacija IP je prikazana na slici \ref{fig:IP}.

\begin{figure}[h!t]
\centering \includegraphics[scale=1]{IP.jpg}
\caption{Inicijalna permutacija}
\label{fig:IP}
\end{figure}

Zatim napišemo $x_0$ u obliku konkatenacije dva \textit{stringa bitova} koji su duljine 32 bita svaki: $x_0=L_0R_0$ 
Nakon toga računamo $L_i$ i $R_i$, gdje je:
\[L_i=R_{i-1}\]
\[R_i=L_{i-1} \oplus f(R_{i-1}, K_i)\]
Gdje su $K_1,...,K_{16}$ \textit{riječi bitova} duljine 48, dobiveni permutiranjem nekih bitova iz $K$. $\oplus$ je operacija \textit{ekskluzivno ili} opisana slikom \ref{fig:XOR}

\begin{figure}[h]
\centering \includegraphics[scale=0.8]{XOR.png}
\caption{Operacija \textit{ekskluzivno ili}}
\label{fig:XOR}
\end{figure}
Sada ćemo opisati dijelovanje funkcije $f:\{0,1\}^{32} \times \{0,1\}^{48} \to \{0,1\}^{32}$. Pretpostavimo da su argumenti funkcije riječ $A$ duljine 32 i $J$ duljine 48.
Prvo niz $A$ proširimo do riječi bitova duljine 48 primjenjujući funkciju $E:\{0,1\}^{32} \to \{0,1\}^{48}$ danu slikom \ref{fig:fjaE} koja $i$-tom bitu, pridruži $E(i)$-ti bit riječi $A$ koji se nalazi na $i$-tom mjestu tablice čitajući s lijeva na desno. Očigledno je da se 16 bitova riječi $A$ "ponavlja".
\begin{figure}[h]
\centering \includegraphics[scale=1]{E.jpg}
\caption{Preslikavanje \textit{E}}
\label{fig:fjaE}
\end{figure}
Uzmemo da je $B=E(A)\oplus J$ te prikažemo $B$ kao konkatenaciju osam riječi sastavljenih od bitova koje su duljine šest, odnosno: $B=B_0B_1B_2B_3B_4B_5B_6B_7B_8$. U sljedećem koraku algoritma koristimo $S-kutije$ (\textit{supstitucijske kutije}) $S_1, ..., S_8$ (prikazane na slici \ref{fig:sbox}), od kojih je svaki $S_i \in \{0,...,15\}^{4\times 16}$ matrica sa 4 retka i 16 stupaca čiji su elementi iz skupa $\{0,...,15\}$. Neka je svaki $B_j=b_1^{(j)}...b_6^{(j)}$. Sada računamo $S_j(B_j)$ prema sljedećem opisu:\\$r_j=b_1^{(j)}b_6^{(j)}$ binarni zapis $r_j$-tog retka od $S_j$, a $c_j=b_2^{(j)}b_3^{(j)}b_4^{(j)}b_5^{(j)}$ binarni zapis $c_j$-tog stupca matrice $S_j$. Definiramo: $C_j=S_j(B_j)=S_j(r_j, c_j), j=1,...,8$ zapisano kao riječ (broj) sastavljenu od 4 bita. Sada riječ $C=C_1C_2C_3C_4C_5C_6C_7C_8$ sastavljenu od 32 bita permutiramo pomoću fiksne \textit{završne permutacije} $P$ prikazane na slici \ref{fig:permP}. U konačnici, vrijedi da je $f(A,J)=P(C)$.	
\begin{figure}[h]
\centering \includegraphics[scale=1]{P.jpg}
\caption{Završna permutacija}
\label{fig:permP}
\end{figure}

Sada opisujemo računanje $K_1,...,K_{16}$ iz $K=k_1...k_{64}$. Bitovi, čiji je indeks $l*8, l=1,...,8$ služe za testiranje pariteta, definirani su tako da svakih osam bitova (jedan bajt), čitajući s lijeva na desno, sadrži neparan broj jedinica. Navedene (paritetne) bitove ignoriramo kod računanja tablice ključeva, a preostale bitove permutiramo  pomoću fiksne permutacije $PC1$ dane slikom \ref{fig:PC1}. Neka je sada $PC1(K)=C_0D_0$, tako da je $d(C_0)=d(D_0)=28$. Sada za svaki $i \in \{1,...,16\}$ računamo:
\[C_i=\begin{cases}^1\overleftarrow{C_{i-1}} &\mbox{ako } i=1,2,9,16 \\  ^2\overleftarrow{C_{i-1}} &\mbox{inače } \end{cases}\]
\[D_i=\begin{cases}^1\overleftarrow{D_{i-1}} &\mbox{ako } i=1,2,9,16 \\  ^2\overleftarrow{D_{i-1}} &\mbox{inače } \end{cases}\]
\[K_i=PC2(C_iD_i)\]
Gdje je $PC2$ fiksna permutacija opisana slikom \ref{fig:PC2}, a operator $^j\overleftarrow{A}$ predstavlja ciklički pomak ulijevo za  $j$ mjesta nad riječi $A$ sasatavljenoj od bitova.
\begin{figure}[h]
\centering \includegraphics[scale=0.8]{PC1.jpg}
\caption{Fiksna permutacija $PC1$}
\label{fig:PC1}
\end{figure}

\begin{figure}[h]
\centering \includegraphics[scale=0.8]{PC2.jpg}
\caption{Fiksna permutacija $PC2$}
\label{fig:PC2}
\end{figure}

Nakon tog cijelog postupka primjenimo \textit{inverznu permutaciju} $IP^{-1}$ na $R_{16}L_{16}$, a onda je šifrat $y$ dan sa:
\[y=IP^{-1}(R_{16}L_{16})\]
Primjetimo da smo sa inverznom permutacijom dijelovali na riječ $R_{16}L_{16}$,a ne $L_{16}$ i $R_{16}$ (obrnuti poredak). Permutacija $IP^{-1}$ je prikazana slikom \ref{fig:invIP}.
Postupak za deđifriranje je analogan:\\
Krećemo od šifrata $y$: na njega najprije primjenimo permutaciju IP sa slike \ref{fig:IP}, $y_0=IP(y)=IP(IP^{-1}(R_{16}L_{16}))=R_{16}L{16}$.  A sada imamo:
\[R_{15}=L_{16}\]
A iz 
\[R_{16}=L_{15} \oplus f(R_{15}, K_{16})\]
Slijedi
\[L_{15}=R_{16} \oplus f(R_{15}, K_{16})\]
Općenito, za sve $i=1,...,16$ dobivamo da vrijedi:
\[R_{16-i}=L_{16-i+1}\]
\[L_{16-i}=R_{16-i+1} \oplus f(R_{16-i}, K_{16-i+1})\]
Iz čega dobivamo niz $R_{14}L_{14},R_{13}L_{13},...R_{0}L_{0}$. A zatim zamjenom poretka od $R_{0}L_{0}$ i primjenom na to $IP^{-1}$ dobivamo:
$IP^{-1}(L_0R_0)=IP^{-1}(IP(x))=x$
Pa smo dobili traženi otvoreni tekst. Primjer šifriranja otvorenog teksta pomoću DES kriptosustava može se naći na \cite{DESexa}. O implementaciji DES-a na DNA računalu se može naći u \cite{DESDNA}, u ovom radu, fokusirat ćemo se više na provaljivanje DES kriptosustava opisanom u idućem poglavlju.
\begin{figure}[h]
\centering \includegraphics[scale=0.7]{invIP.jpg}
\caption{Inverzna permutacija $IP^{-1}$}
\label{fig:invIP}
\end{figure}

\begin{figure}[h]
\centering \includegraphics[scale=0.52]{S-box.jpg}
\caption{$S$-kutije}
\label{fig:sbox}
\end{figure}
 \newpage
\subsection{Provaljivanje DES-a DNA izračunavanjem}
U poglavlju \ref{sec:DNAizr} smo naveli opisnu definiciju DNA računala koju je predložio Leonard Adleman, a u poglavlju \ref{sec:DNA} su navedene osnovne činjenice i neke od biokemijskih operacija koje se koriste u genetičkom inženjeringu. U ovom poglavlju ćemo koristiti operacije navedene upravo u \ref{sec:DNA} te nećemo te operacije striktno definirati u definiciji navedenoj u poglavlju \ref{sec:DNAizr} premda bi se mogle. Naime, ta definicija je služila kao osnovni matematički koncept kojeg je predložio Adleman, a koji se kasnije postupno proširivao. Kako su se proširivala istraživanja o DNA i genetičkom inženjeringu, tako bi se i dana definicija mogla izmjenjivati. Opisat ćemo oznake i biokemijske operacije koje ćemo koristiti.
Neka je $x$ proizvoljna riječ alfabeta $\Sigma =\{\mathtt{A,C,G,T}\}$. Biološki gledano, $x$ nije još DNA lanac jer nema orijentaciju. Nadalje, uvodimo Watson-Crickov komplement (biološki komplement u poglavlju \ref{sec:DNAizr}). To je preslikavanje opisano sa ($\mathtt{A \to T, T \to A, G \to C, C \to W}$). Watson-Crickov komplement označavat ćemo sa $\overline{x}$. Sa $x^R$ ćemo označavati riječ koja je sastavljena od istih simbola kao i riječ $x$ samo u obrnutom poretku. Sa $\mathtt{\uparrow} x$ ćemo označavati  jednolančani DNA čija je orijentacija $\mathtt{5' \to 3'}$, a sastavljena  je od niza simbola od kojih se sastoji $x$. Sa $\downarrow x$ ćemo označavati lanac orijentacije $3'->5'$ sa nizom simbola koji čine Watskon-Crickov komplement niza $x$. U konačnici, sa $\mathtt{\updownarrow x}$ označavamo dvolančanu strukturu nastalu spajanjem $\mathtt{\uparrow x}$ i $\mathtt{\downarrow x}$. Kako bi svatili sve oznake napravit ćemo jedan primjer:
\begin{exa}
Neka je $x=\mathtt{TGCCGCAG}$ riječ alfabeta $\Sigma=\mathtt{\{A,C,G,T\}}$, tada je:
\[\overline{x}= \mathtt{ACGGCGTC}\]
\[x^R=\mathtt{GACGCCGT}\]
\[\uparrow x=\mathtt{5'-TGCCGCAG-3'}\]
\[\downarrow x=\mathtt{3'-ACGGCGTC-5'}=	\uparrow \overline{x}^R\]
\[\updownarrow x=\mathtt{{5'-TGCCGCAG-3' \atop 3'-ACGGCGTC-5'}}\]
\end{exa}

\section{Enkripcija i dekripcija podataka}

\newpage
\nocite{*}
\bibliographystyle{abbrv}
\bibliography{borda2011fundamentals,literatura,CNTYan,lipton,DESDNA}
\end{spacing}
\end{document}